all_data <- rawData_list %>%
bind_rows()
all_data$accel_bw <- c(NA, with(all_data, diff(velocity_bw)/diff(elapsed_time)))
all_data$acc <- c(NA, with(all_data, diff(velocity_raw_bw)/diff(elapsed_time)))
trial_mutate_slice <- all_data %>% slice(40476:40550)
trial_mutate_slice <- trial_mutate_slice %>% mutate(time = row_number())
ggplot(trial_mutate_slice, aes (x = elapsed_time)) +
geom_line(aes(y = velocity), color = "red") +
geom_line(aes(y = velocity_bw), color = "green") +
geom_line(aes(y= velocity_raw_bw), color = "blue") +
geom_line(aes(y = acceleration), color = "black") +
geom_line(aes(y = acc), color = "orange") +
theme_bw()
all_data %>%
ggplot(aes(x = velocity_raw_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
#Set filter details
bf4 <- butter(2, 0.10, type="low")
#Apply filter
rawData_list <- data %>%
#Delete NA's
map(~na.omit(.)) %>%
map(~mutate(.data = ., velocity_bw = filtfilt(bf4, .$velocity))) %>%
map(~mutate(.data = ., velocity_raw_bw = filtfilt(bf4, .$velocity_raw)))
all_data <- rawData_list %>%
bind_rows()
all_data$accel_bw <- c(NA, with(all_data, diff(velocity_bw)/diff(elapsed_time)))
all_data$acc <- c(NA, with(all_data, diff(velocity_raw_bw)/diff(elapsed_time)))
trial_mutate_slice <- all_data %>% slice(40476:40550)
trial_mutate_slice <- trial_mutate_slice %>% mutate(time = row_number())
ggplot(trial_mutate_slice, aes (x = elapsed_time)) +
geom_line(aes(y = velocity), color = "red") +
geom_line(aes(y = velocity_bw), color = "green") +
geom_line(aes(y= velocity_raw_bw), color = "blue") +
geom_line(aes(y = acceleration), color = "black") +
geom_line(aes(y = acc), color = "orange") +
theme_bw()
all_data %>%
ggplot(aes(x = velocity_raw_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
#Set filter details
bf4 <- butter(2, 0.12, type="low")
#Apply filter
rawData_list <- data %>%
#Delete NA's
map(~na.omit(.)) %>%
map(~mutate(.data = ., velocity_bw = filtfilt(bf4, .$velocity))) %>%
map(~mutate(.data = ., velocity_raw_bw = filtfilt(bf4, .$velocity_raw)))
all_data <- rawData_list %>%
bind_rows()
all_data$accel_bw <- c(NA, with(all_data, diff(velocity_bw)/diff(elapsed_time)))
all_data$acc <- c(NA, with(all_data, diff(velocity_raw_bw)/diff(elapsed_time)))
trial_mutate_slice <- all_data %>% slice(40476:40550)
trial_mutate_slice <- trial_mutate_slice %>% mutate(time = row_number())
ggplot(trial_mutate_slice, aes (x = elapsed_time)) +
geom_line(aes(y = velocity), color = "red") +
geom_line(aes(y = velocity_bw), color = "green") +
geom_line(aes(y= velocity_raw_bw), color = "blue") +
geom_line(aes(y = acceleration), color = "black") +
geom_line(aes(y = acc), color = "orange") +
theme_bw()
all_data %>%
ggplot(aes(x = velocity_raw_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
#Set filter details
bf4 <- butter(2, 0.15, type="low")
#Apply filter
rawData_list <- data %>%
#Delete NA's
map(~na.omit(.)) %>%
map(~mutate(.data = ., velocity_bw = filtfilt(bf4, .$velocity))) %>%
map(~mutate(.data = ., velocity_raw_bw = filtfilt(bf4, .$velocity_raw)))
all_data <- rawData_list %>%
bind_rows()
all_data$accel_bw <- c(NA, with(all_data, diff(velocity_bw)/diff(elapsed_time)))
all_data$acc <- c(NA, with(all_data, diff(velocity_raw_bw)/diff(elapsed_time)))
trial_mutate_slice <- all_data %>% slice(40476:40550)
trial_mutate_slice <- trial_mutate_slice %>% mutate(time = row_number())
ggplot(trial_mutate_slice, aes (x = elapsed_time)) +
geom_line(aes(y = velocity), color = "red") +
geom_line(aes(y = velocity_bw), color = "green") +
geom_line(aes(y= velocity_raw_bw), color = "blue") +
geom_line(aes(y = acceleration), color = "black") +
geom_line(aes(y = acc), color = "orange") +
theme_bw()
all_data %>%
ggplot(aes(x = velocity_raw_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
#Set filter details
bf4 <- butter(2, 0.05, type="low")
#Apply filter
rawData_list <- data %>%
#Delete NA's
map(~na.omit(.)) %>%
map(~mutate(.data = ., velocity_bw = filtfilt(bf4, .$velocity))) %>%
map(~mutate(.data = ., velocity_raw_bw = filtfilt(bf4, .$velocity_raw)))
all_data <- rawData_list %>%
bind_rows()
all_data$accel_bw <- c(NA, with(all_data, diff(velocity_bw)/diff(elapsed_time)))
all_data$acc <- c(NA, with(all_data, diff(velocity_raw_bw)/diff(elapsed_time)))
trial_mutate_slice <- all_data %>% slice(40476:40550)
trial_mutate_slice <- trial_mutate_slice %>% mutate(time = row_number())
ggplot(trial_mutate_slice, aes (x = elapsed_time)) +
geom_line(aes(y = velocity), color = "red") +
geom_line(aes(y = velocity_bw), color = "green") +
geom_line(aes(y= velocity_raw_bw), color = "blue") +
geom_line(aes(y = acceleration), color = "black") +
geom_line(aes(y = acc), color = "orange") +
theme_bw()
all_data %>%
ggplot(aes(x = velocity_raw_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
ggplot(trial_mutate_slice, aes (x = elapsed_time)) +
geom_line(aes(y = velocity), color = "red") +
geom_line(aes(y = velocity_bw), color = "green") +
geom_line(aes(y= velocity_raw_bw), color = "blue") +
geom_line(aes(y = acceleration), color = "black") +
geom_line(aes(y = acc), color = "orange") +
theme_bw()
#Set filter details
bf4 <- butter(2, 0.10, type="low")
#Apply filter
rawData_list <- data %>%
#Delete NA's
map(~na.omit(.)) %>%
map(~mutate(.data = ., velocity_bw = filtfilt(bf4, .$velocity))) %>%
map(~mutate(.data = ., velocity_raw_bw = filtfilt(bf4, .$velocity_raw)))
all_data <- rawData_list %>%
bind_rows()
all_data$accel_bw <- c(NA, with(all_data, diff(velocity_bw)/diff(elapsed_time)))
all_data$acc <- c(NA, with(all_data, diff(velocity_raw_bw)/diff(elapsed_time)))
trial_mutate_slice <- all_data %>% slice(40476:40550)
trial_mutate_slice <- trial_mutate_slice %>% mutate(time = row_number())
ggplot(trial_mutate_slice, aes (x = elapsed_time)) +
geom_line(aes(y = velocity), color = "red") +
geom_line(aes(y = velocity_bw), color = "green") +
geom_line(aes(y= velocity_raw_bw), color = "blue") +
geom_line(aes(y = acceleration), color = "black") +
geom_line(aes(y = acc), color = "orange") +
theme_bw()
all_data %>%
ggplot(aes(x = velocity, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
all_data %>%
ggplot(aes(x = velocity_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
all_data %>%
ggplot(aes(x = velocity_raw_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
#Set filter details
bf4 <- butter(2, 0.15, type="low")
#Apply filter
rawData_list <- data %>%
#Delete NA's
map(~na.omit(.)) %>%
map(~mutate(.data = ., velocity_bw = filtfilt(bf4, .$velocity))) %>%
map(~mutate(.data = ., velocity_raw_bw = filtfilt(bf4, .$velocity_raw)))
all_data <- rawData_list %>%
bind_rows()
all_data$accel_bw <- c(NA, with(all_data, diff(velocity_bw)/diff(elapsed_time)))
#Set filter details
bf4 <- butter(2, 0.15, type="low")
#Apply filter
rawData_list <- data %>%
#Delete NA's
map(~na.omit(.)) %>%
map(~mutate(.data = ., velocity_bw = filtfilt(bf4, .$velocity))) %>%
map(~mutate(.data = ., velocity_raw_bw = filtfilt(bf4, .$velocity_raw)))
all_data <- rawData_list %>%
bind_rows()
all_data$accel_bw <- c(NA, with(all_data, diff(velocity_bw)/diff(elapsed_time)))
all_data$acc <- c(NA, with(all_data, diff(velocity_raw_bw)/diff(elapsed_time)))
#Set filter details
bf4 <- butter(2, 0.15, type="low")
#Apply filter
rawData_list <- data %>%
#Delete NA's
map(~na.omit(.)) %>%
map(~mutate(.data = ., velocity_bw = filtfilt(bf4, .$velocity))) %>%
map(~mutate(.data = ., velocity_raw_bw = filtfilt(bf4, .$velocity_raw)))
rawData_list_acc <- rawData_list %>%
map(~mutate(.data = .,
reg_acc = runner(x = .,
k = 5,
na_pad = FALSE,
f = function(x){
model <- lm(velocity_raw_bw ~ elapsed_time,
data = x)
coefficients(model)[2]})))
library(runner)
library(runner)
rawData_list_acc <- rawData_list %>%
map(~mutate(.data = .,
reg_acc = runner(x = .,
k = 5,
na_pad = FALSE,
f = function(x){
model <- lm(velocity_raw_bw ~ elapsed_time,
data = x)
coefficients(model)[2]})))
rawData_list_shifted <- rawData_list_acc %>%
map(~shift.column(data = .,
columns = "reg_acc",
newNames = "acc",
up = TRUE, len = 0))
library(useful)
rawData_list_shifted <- rawData_list_acc %>%
map(~shift.column(data = .,
columns = "reg_acc",
newNames = "acc",
up = TRUE, len = 0))
trial_mutate_slice <- all_data %>% slice(40476:40550)
trial_mutate_slice <- trial_mutate_slice %>% mutate(time = row_number())
ggplot(trial_mutate_slice, aes (x = elapsed_time)) +
geom_line(aes(y = velocity), color = "red") +
geom_line(aes(y = velocity_bw), color = "green") +
geom_line(aes(y= velocity_raw_bw), color = "blue") +
geom_line(aes(y = acceleration), color = "black") +
geom_line(aes(y = acc), color = "orange") +
theme_bw()
all_data %>%
ggplot(aes(x = velocity_raw_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
rawData_list_shifted <- rawData_list_acc %>%
map(~shift.column(data = .,
columns = "reg_acc",
newNames = "acc",
up = TRUE, len = 2))
rawData_list_shifted <- rawData_list_acc %>%
map(~shift.column(data = .,
columns = "reg_acc",
newNames = "acc",
up = TRUE, len = 0))
all_data <- rawData_list_shifted %>%
bind_rows()
trial_mutate_slice <- all_data %>% slice(40476:40550)
trial_mutate_slice <- trial_mutate_slice %>% mutate(time = row_number())
ggplot(trial_mutate_slice, aes (x = elapsed_time)) +
geom_line(aes(y = velocity), color = "red") +
geom_line(aes(y = velocity_bw), color = "green") +
geom_line(aes(y= velocity_raw_bw), color = "blue") +
geom_line(aes(y = acceleration), color = "black") +
geom_line(aes(y = acc), color = "orange") +
theme_bw()
all_data %>%
ggplot(aes(x = velocity_raw_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
rawData_list_shifted <- rawData_list_acc %>%
map(~shift.column(data = .,
columns = "reg_acc",
newNames = "acc",
up = TRUE, len = 2))
all_data <- rawData_list_shifted %>%
bind_rows()
trial_mutate_slice <- all_data %>% slice(40476:40550)
trial_mutate_slice <- trial_mutate_slice %>% mutate(time = row_number())
ggplot(trial_mutate_slice, aes (x = elapsed_time)) +
geom_line(aes(y = velocity), color = "red") +
geom_line(aes(y = velocity_bw), color = "green") +
geom_line(aes(y= velocity_raw_bw), color = "blue") +
geom_line(aes(y = acceleration), color = "black") +
geom_line(aes(y = acc), color = "orange") +
theme_bw()
all_data %>%
ggplot(aes(x = velocity_raw_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
all_data %>%
ggplot(aes(x = velocity_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
all_data %>%
ggplot(aes(x = velocity, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
rawData_list_acc <- rawData_list %>%
map(~mutate(.data = .,
reg_acc = runner(x = .,
k = 10,
na_pad = FALSE,
f = function(x){
model <- lm(velocity_raw_bw ~ elapsed_time,
data = x)
coefficients(model)[2]})))
rawData_list_shifted <- rawData_list_acc %>%
map(~shift.column(data = .,
columns = "reg_acc",
newNames = "acc",
up = TRUE, len = 2))
all_data <- rawData_list_shifted %>%
bind_rows()
trial_mutate_slice <- all_data %>% slice(40476:40550)
trial_mutate_slice <- trial_mutate_slice %>% mutate(time = row_number())
ggplot(trial_mutate_slice, aes (x = elapsed_time)) +
geom_line(aes(y = velocity), color = "red") +
geom_line(aes(y = velocity_bw), color = "green") +
geom_line(aes(y= velocity_raw_bw), color = "blue") +
geom_line(aes(y = acceleration), color = "black") +
geom_line(aes(y = acc), color = "orange") +
theme_bw()
all_data %>%
ggplot(aes(x = velocity_raw_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
#Set filter details
bf4 <- butter(2, 0.10, type="low")
#Apply filter
rawData_list <- data %>%
#Delete NA's
map(~na.omit(.)) %>%
map(~mutate(.data = ., velocity_bw = filtfilt(bf4, .$velocity))) %>%
map(~mutate(.data = ., velocity_raw_bw = filtfilt(bf4, .$velocity_raw)))
all_data <- rawData_list %>%
bind_rows()
all_data$accel_bw <- c(NA, with(all_data, diff(velocity_bw)/diff(elapsed_time)))
all_data$acc <- c(NA, with(all_data, diff(velocity_raw_bw)/diff(elapsed_time)))
trial_mutate_slice <- all_data %>% slice(40476:40550)
trial_mutate_slice <- trial_mutate_slice %>% mutate(time = row_number())
ggplot(trial_mutate_slice, aes (x = elapsed_time)) +
geom_line(aes(y = velocity), color = "red") +
geom_line(aes(y = velocity_bw), color = "green") +
geom_line(aes(y= velocity_raw_bw), color = "blue") +
geom_line(aes(y = acceleration), color = "black") +
geom_line(aes(y = acc), color = "orange") +
theme_bw()
all_data %>%
ggplot(aes(x = velocity_raw_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
library(InSituASProfile)
all_data <- all_data %>%
rename(speed = velocity_raw_bw)
InSituASProfile::prepare_data(all_data,print_plot = TRUE)
InSituASProfile::get_AS_Profile()
#Set filter details
bf4 <- butter(4, 0.10, type="low")
#Apply filter
rawData_list <- data %>%
#Delete NA's
map(~na.omit(.)) %>%
map(~mutate(.data = ., velocity_bw = filtfilt(bf4, .$velocity))) %>%
map(~mutate(.data = ., velocity_raw_bw = filtfilt(bf4, .$velocity_raw)))
all_data <- rawData_list %>%
bind_rows()
all_data$accel_bw <- c(NA, with(all_data, diff(velocity_bw)/diff(elapsed_time)))
all_data$acc <- c(NA, with(all_data, diff(velocity_raw_bw)/diff(elapsed_time)))
trial_mutate_slice <- all_data %>% slice(40476:40550)
trial_mutate_slice <- trial_mutate_slice %>% mutate(time = row_number())
ggplot(trial_mutate_slice, aes (x = elapsed_time)) +
geom_line(aes(y = velocity), color = "red") +
geom_line(aes(y = velocity_bw), color = "green") +
geom_line(aes(y= velocity_raw_bw), color = "blue") +
geom_line(aes(y = acceleration), color = "black") +
geom_line(aes(y = acc), color = "orange") +
theme_bw()
all_data %>%
ggplot(aes(x = velocity_raw_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
#Set filter details
bf4 <- butter(2, 1, type="low")
#Apply filter
rawData_list <- data %>%
#Delete NA's
map(~na.omit(.)) %>%
map(~mutate(.data = ., velocity_bw = filtfilt(bf4, .$velocity))) %>%
map(~mutate(.data = ., velocity_raw_bw = filtfilt(bf4, .$velocity_raw)))
all_data <- rawData_list %>%
bind_rows()
all_data$accel_bw <- c(NA, with(all_data, diff(velocity_bw)/diff(elapsed_time)))
all_data$acc <- c(NA, with(all_data, diff(velocity_raw_bw)/diff(elapsed_time)))
trial_mutate_slice <- all_data %>% slice(40476:40550)
trial_mutate_slice <- trial_mutate_slice %>% mutate(time = row_number())
ggplot(trial_mutate_slice, aes (x = elapsed_time)) +
geom_line(aes(y = velocity), color = "red") +
geom_line(aes(y = velocity_bw), color = "green") +
geom_line(aes(y= velocity_raw_bw), color = "blue") +
geom_line(aes(y = acceleration), color = "black") +
geom_line(aes(y = acc), color = "orange") +
theme_bw()
#Set filter details
bf4 <- butter(2, 0.15, type="low")
#Apply filter
rawData_list <- data %>%
#Delete NA's
map(~na.omit(.)) %>%
map(~mutate(.data = ., velocity_bw = filtfilt(bf4, .$velocity))) %>%
map(~mutate(.data = ., velocity_raw_bw = filtfilt(bf4, .$velocity_raw)))
all_data <- rawData_list %>%
bind_rows()
all_data$acc <- c(NA, with(all_data, diff(velocity_bw)/diff(elapsed_time)))
all_data$accel_raw_bw <- c(NA, with(all_data, diff(velocity_raw_bw)/diff(elapsed_time)))
trial_mutate_slice <- all_data %>% slice(40476:40550)
trial_mutate_slice <- trial_mutate_slice %>% mutate(time = row_number())
ggplot(trial_mutate_slice, aes (x = elapsed_time)) +
geom_line(aes(y = velocity), color = "red") +
geom_line(aes(y = velocity_bw), color = "green") +
geom_line(aes(y= velocity_raw_bw), color = "blue") +
geom_line(aes(y = acceleration), color = "black") +
geom_line(aes(y = acc), color = "orange") +
theme_bw()
all_data %>%
ggplot(aes(x = velocity_raw_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
all_data %>%
ggplot(aes(x = velocity_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
all_data <- all_data %>%
rename(speed = velocity_bw)
InSituASProfile::prepare_data(all_data,print_plot = TRUE)
InSituASProfile::get_AS_Profile()
all_data <- all_data %>%
rename(speed = velocity_raw_bw)
InSituASProfile::prepare_data(all_data,print_plot = TRUE)
#Set filter details
bf4 <- butter(2, 0.20, type="low")
#Apply filter
rawData_list <- data %>%
#Delete NA's
map(~na.omit(.)) %>%
map(~mutate(.data = ., velocity_bw = filtfilt(bf4, .$velocity))) %>%
map(~mutate(.data = ., velocity_raw_bw = filtfilt(bf4, .$velocity_raw)))
all_data <- rawData_list %>%
bind_rows()
all_data$acc <- c(NA, with(all_data, diff(velocity_bw)/diff(elapsed_time)))
all_data$accel_raw_bw <- c(NA, with(all_data, diff(velocity_raw_bw)/diff(elapsed_time)))
trial_mutate_slice <- all_data %>% slice(40476:40550)
trial_mutate_slice <- trial_mutate_slice %>% mutate(time = row_number())
ggplot(trial_mutate_slice, aes (x = elapsed_time)) +
geom_line(aes(y = velocity), color = "red") +
geom_line(aes(y = velocity_bw), color = "green") +
geom_line(aes(y= velocity_raw_bw), color = "blue") +
geom_line(aes(y = acceleration), color = "black") +
geom_line(aes(y = acc), color = "orange") +
theme_bw()
all_data %>%
ggplot(aes(x = velocity_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
all_data <- all_data %>%
rename(speed = velocity_raw_bw)
InSituASProfile::prepare_data(all_data,print_plot = TRUE)
all_data %>%
ggplot(aes(x = velocity_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
all_data <- all_data %>%
rename(speed = velocity_raw_bw)
InSituASProfile::prepare_data(all_data,print_plot = TRUE)
InSituASProfile::get_AS_Profile()
#Set filter details
bf4 <- butter(2, 0.15, type="low")
#Apply filter
rawData_list <- data %>%
#Delete NA's
map(~na.omit(.)) %>%
map(~mutate(.data = ., velocity_bw = filtfilt(bf4, .$velocity))) %>%
map(~mutate(.data = ., velocity_raw_bw = filtfilt(bf4, .$velocity_raw)))
all_data <- rawData_list %>%
bind_rows()
all_data$accel_bw <- c(NA, with(all_data, diff(velocity_bw)/diff(elapsed_time)))
all_data$acc <- c(NA, with(all_data, diff(velocity_raw_bw)/diff(elapsed_time)))
trial_mutate_slice <- all_data %>% slice(40476:40550)
trial_mutate_slice <- trial_mutate_slice %>% mutate(time = row_number())
ggplot(trial_mutate_slice, aes (x = elapsed_time)) +
geom_line(aes(y = velocity), color = "red") +
geom_line(aes(y = velocity_bw), color = "green") +
geom_line(aes(y= velocity_raw_bw), color = "blue") +
geom_line(aes(y = acceleration), color = "black") +
geom_line(aes(y = acc), color = "orange") +
theme_bw()
all_data %>%
ggplot(aes(x = velocity_raw_bw, y = acc)) +
geom_point(size = 0.2) +
ylim(0,NA) +
geom_vline(xintercept = 3, color = "red")
all_data <- all_data %>%
rename(speed = velocity_raw_bw)
InSituASProfile::prepare_data(all_data,print_plot = TRUE)
InSituASProfile::get_AS_Profile()
